1. Refactory builtin functions
2. Add more tests
